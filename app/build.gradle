// Top-level plugins definition
plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
}

android {
    namespace 'com.example.liefantidia' 
    compileSdk 34

    defaultConfig {
        applicationId "com.example.liefantidia"
        minSdk 24
        targetSdk 34
        versionCode 1
        versionName "1.0"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    // ------------------------------------------------------------------
    // ğŸ’¡ ãƒªãƒªãƒ¼ã‚¹ç½²åè¨­å®šãƒ–ãƒ­ãƒƒã‚¯ (CIã®ç’°å¢ƒå¤‰æ•°ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã€ç½²åã‚’å¼·åˆ¶)
    // ------------------------------------------------------------------
    signingConfigs {
        release {
            // GitHub Actionsã®YAMLã‹ã‚‰æ¸¡ã•ã‚Œã‚‹ç’°å¢ƒå¤‰æ•°ã‚’å–å¾—
            def keystoreFile = System.getenv('SIGNING_KEY_FILE')
            def keystorePass = System.getenv('KEYSTORE_PASSWORD')
            def keyAlias = System.getenv('KEY_ALIAS')
            def keyPass = System.getenv('KEY_PASSWORD')
            
            // ç’°å¢ƒå¤‰æ•°ãŒå­˜åœ¨ã™ã‚‹å ´åˆï¼ˆ=CIç’°å¢ƒã¨åˆ¤æ–­ï¼‰ã®ã¿ç½²åè¨­å®šã‚’é©ç”¨
            if (keystoreFile != null && keystorePass != null && keyAlias != null && keyPass != null) {
                // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®š
                storeFile file(keystoreFile)
                storePassword keystorePass
                keyAlias keyAlias
                keyPassword keyPass
                
                // ç½²åã‚¹ã‚­ãƒ¼ãƒ  V1/V2 ã‚’å¼·åˆ¶çš„ã«æœ‰åŠ¹åŒ–ã—ã€å¤ã„Androidãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ–°ã—ã„Androidãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸¡æ–¹ã«å¯¾å¿œã•ã›ã‚‹
                v1SigningEnabled true
                v2SigningEnabled true
            } else {
                // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ã‚„ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›
                println "WARNING: CI environment variables for release signing were not found. Building unsigned APK."
            }
        }
    }
    // ------------------------------------------------------------------

    buildTypes {
        release {
            // Minify/é›£èª­åŒ–è¨­å®š
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            
            // ğŸ’¡ ç½²åè¨­å®šã‚’ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã‚¿ã‚¤ãƒ—ã«é©ç”¨
            signingConfig signingConfigs.release
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }

    kotlinOptions {
        jvmTarget = '17'
    }
}

dependencies {
    // AndroidX Core and UI libraries
    implementation 'androidx.core:core-ktx:1.13.1' 
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'com.google.android.material:material:1.11.0' 
    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'

    // BiometricPrompt
    implementation 'androidx.biometric:biometric:1.1.0' 

    // OkHttp
    implementation 'com.squareup.okhttp3:okhttp:4.12.0' 

    // Test dependencies
    testImplementation 'junit:junit:4.13.2'
    androidTestImplementation 'androidx.test.ext:junit:1.1.5'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'
}